<h1>Git Collector</h1><h2>Anforderungen</h2><ul>	<li>Installiert sind <font face="Consolas"><mark>docker</mark></font> und <font face="Consolas"><mark>docker-compose</mark></font> (letzteres in einer Version, die Compose-Dateien mit <font face="Consolas"><mark>version: '3.7</mark></font> oder höher unterstützt).</li>	<li>Die Hauptanwendung aus dem Ordner <mark>main</mark> läuft bereits in einem Docker Container.</li></ul><h2>Einrichtung des Git Collectors</h2><ol>	<li>Navigieren Sie in den Ordner <font face="Consolas"><mark>config/collectorConfiguration</mark></font></li>	<li>Bearbeiten Sie die Datei <font face="Consolas"><mark>gitCredentials.json</mark></font>. Dort fügen Sie bitte die URL Ihrer Git-Repo und dazugehörige Zugangsdaten ein, damit der GitCollector das Repository im Container klonen und pullen kann. <font face="Consolas"><mark>Achtung! Es muss die URL zum Klonen sein.</mark></font></li>	<li>Bearbeiten Sie die Datei <font face="Consolas"><mark>gitTimestamp.json</mark></font>. Im Attribut timestamp ist es für die erste Ausführung empfehlenswert ein Datum einzufügen, das weiter in der Vergangenheit liegt, da der GitCollector nur Commits beachtet, die ab dem Timestamp passiert sind, um auch z.B. später das doppelte Zählen von Commits zu vermeiden. Die Syntax ist immer "TAG-MONAT-JAHR STUNDE:MINUTE:SEKUNDE". Dabei wird das Jahr voll ausgeschrieben und die Monate bestehen aus den ersten 3 Buchstaben der englischen Namen der Monate <font face="Consolas"><mark>z.B. July = Jul</mark></font>. Das Attribut Threshold wird in Millisekunden angegeben und sagt aus wie lang die pause zwischen den Pulls vom GitCollector ist, damit das Programm nicht mit mehreren Pulls auf einmal überlastet wird.</li>	<li>Es muss noch ein Webhook in Ihrem Git-Repo eingerichtet, die auf die API des GitCollectors postet. Die Anwendung kann jedoch schon mit dem Befehl <font face="Consolas"><mark>docker-compose up --build</mark></font> gestartet werden sofern die Hauptanwendung und Docker bereits laufen.</li></ol><h2>Einrichtung des Webhooks</h2>Je nach dem, ob Ihr Git Environment im gleichen Docker Netzwerk laufen wird oder nicht wird Ihr Link für den Webhook anders aussehen.<br><br>Läuft das Git Environment im gleichen Docker Netzwerk wie der GitCollector, können Sie als URL für den Webhook <font face="Consolas"><mark>http://GitCollector:8080/update</mark></font> verwenden. Falls Sie den Container in der <font face="Consolas"><mark>docker-compose.yml</mark></font> umbennen müssen Sie den entsprechenden Namen für den Container in der URL ersetzen. Das Gleiche gilt auch für den Docker-internen Port.<br><br>Läuft das Git Environment <mark>NICHT</mark> im gleichen Docker Netzwerk wie der GitCollector, müssen Sie als URL für den Webhook <font face="Consolas"><mark>http://IHRGATEWAY:9002/update</mark></font> verwenden. Sollten Sie den externen Port in der <font face="Consolas"><mark>docker-compose.yml</mark></font> verändert haben, gilt wie oben, dass dieser dementsprechend auch in der URL verändert wird. <h3>Hinweise für GitLab</h3>Falls Sie in GitLab einen Webhook einfügen möchten und die URL lokal ist z.B. wie im ersten Fall, dass GitLab und der GitCollector im gleichen Netzwerk sind müssen Sie beachten, dass GitLab normalerweise lokale Webhook URLs nicht zulässt.<br>Um dies zu erlauben müssen Sie dies in der Admin Area auch einstellen. Dies geht wie folgt:<br><ol>	<li>Sie loggen sich mit dem root Account ein.</li>	<li>Sie öffnen die Admin Area</li>	<li>Klicken SIe auf Settings</li>	<li>Klicken Sie auf Network</li>	<li>Expanden Sie Outbound request und setzen einen Haken bei <font face="Consolas"><mark>Allow requests to the local network from the web hooks and services</mark></font></li></ol><h3>Einfügen eines Webhooks</h3>Falls Sie nicht wissen, wie Sie einen Webhook in ihr Git-Repository einfügen, können Sie in den entsprechenden Dokumentationen zu den Git Envoronments dies nachlesen.<ul><li><a href="https://confluence.atlassian.com/bitbucket/manage-webhooks-735643732.html">Dokumentation für Bitbucket</a></li><li><a href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html">Dokumentation für GitLab</a></li><li><a href="https://developer.github.com/webhooks/creating/">Dokumentation für GitHub</a></li></ul>